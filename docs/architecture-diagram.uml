@startuml
!define RECTANGLE class

skinparam component {
    BackgroundColor<<external>> LightBlue
    BackgroundColor<<internal>> LightGreen
    BorderColor Black
}

skinparam rectangle {
    BackgroundColor WhiteSmoke
    BorderColor Black
    roundCorner 15
}

skinparam nodesep 80
skinparam ranksep 80
skinparam padding 10
skinparam rectanglePadding 15

left to right direction

title Elastic 3am Alert Killer

' External agents - positioned on the left
component "**Elastic Agent**\n(Monitoring & Detection)\n\n• Reads Microservice Logs\n• Detects Issues/Alerts\n• Diagnoses Problems\n• Triggers A2A Protocol\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                                                                                                                            " as Elastic <<external>> #LightBlue

' System boundary - positioned on the right
rectangle "Elastic 3AM Alerts Killer System" #WhiteSmoke {

    component "**Host Agent**\n(Orchestrator)\n\nAgent: llama-index\n\nTools:\n• store_alert_info\n• execute_commands\n• check_alert_status" as Host <<internal>> #LightGreen

    component "**Report Maker**\n(Reporting Specialist)\n\nAgent: llama-index\n\nTools:\n• query_context\n• get_context_field" as Report <<internal>> #LightGreen

    component "**Remediation Agent**\n(Investigation & Planning)\n\nAgent: llama-index\n\nTools:\n• oc get/describe\n• logs/events" as Remediation <<internal>> #LightGreen

    ' Compact vertical layout
    Host -[hidden]down- Report
    Report -[hidden]down- Remediation

    ' Internal communication with offset routing to prevent overlap
    Host -[#Green,dashed,thickness=2]-> Report : <color:Green>**Handoff**</color>\n<size:10>Report Generation</size>
    Report -[#Green,dashed,thickness=2]-> Host : <color:Green>**Handoff**</color>\n<size:10>Final Report</size>

    Host -[#Green,dashed,thickness=2]-> Remediation : <color:Green>**Handoff**</color>\n<size:10>Investigation Request</size>
    Remediation -[#Green,dashed,thickness=2]-> Host : <color:Green>**Handoff**</color>\n<size:10>Remediation Plan</size>

}

' External communication - direct to Host
Elastic -[#Blue,bold,thickness=2]-> Host : <color:Blue>**A2A Protocol**</color>\n<size:10>POST /agent</size>\n<size:10>(Alert Diagnosis)</size>

Host -[#Blue,bold,thickness=2]-> Elastic : <color:Blue>**A2A Protocol**</color>\n<size:10>Report JSON</size>


legend right
    |= Legend |
    |<#LightBlue> External Agent |
    |<#LightGreen> Internal Agent (lamma-index) |

    **Communication Types:**
    |<#Blue><color:White> ━━━ </color></#Blue>| A2A Protocol (External) |
    |<color:Green> ┅┅┅ </color>| Direct Llama Handoff (Internal) |
endlegend

@enduml
